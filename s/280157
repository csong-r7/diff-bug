

  <upd:Update xmlns:pub="http://schemas.microsoft.com/msus/2002/12/Publishing" xmlns:lar="http://schemas.microsoft.com/msus/2002/12/LogicalApplicabilityRules" xmlns:psf="http://schemas.microsoft.com/msus/2002/12/UpdateHandlers/WindowsPatch" xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" xmlns:upd="http://schemas.microsoft.com/msus/2002/12/Update">
    <upd:UpdateIdentity UpdateID="1cf4c22b-7604-4c69-b27b-9b4be5e5804d" RevisionNumber="103"/>
    <upd:Properties DefaultPropertiesLanguage="en" UpdateType="Software" Handler="http://schemas.microsoft.com/msus/2002/12/UpdateHandlers/WindowsPatch" PublicationState="Published" CreationDate="2006-04-04T21:41:49.758Z" PublisherID="395392a0-19c0-48b7-a927-f7c15066d905" MaxDownloadSize="6087400" MinDownloadSize="921791">
      <upd:InstallationBehavior RebootBehavior="CanRequestReboot"/>
      <upd:Language>zh-tw</upd:Language>
    </upd:Properties>
    <upd:LocalizedPropertiesCollection>
      <upd:LocalizedProperties>
        <upd:Language>en</upd:Language>
        <upd:Title>Binary zh-tw</upd:Title>
      </upd:LocalizedProperties>
    </upd:LocalizedPropertiesCollection>
    <upd:Relationships>
      <upd:Prerequisites>
        <upd:UpdateIdentity UpdateID="7f38e252-29bc-42db-9dad-5377d2fe8703"/>
        <upd:AtLeastOne>
          <upd:UpdateIdentity UpdateID="d8361d81-2d0f-4833-a96b-945ba682bf48"/>
          <upd:UpdateIdentity UpdateID="c5caf853-4c76-47fa-93ec-e49b01db32fd"/>
        </upd:AtLeastOne>
        <upd:UpdateIdentity UpdateID="3e0afb10-a9fb-4c16-a60e-5790c3803437"/>
        <upd:AtLeastOne>
          <upd:UpdateIdentity UpdateID="558f4bc3-4827-49e1-accf-ea79fd72d4c9"/>
        </upd:AtLeastOne>
      </upd:Prerequisites>
    </upd:Relationships>
    <upd:ApplicabilityRules>
      <upd:IsInstalled>
        <lar:Or xmlns:lar="http://schemas.microsoft.com/msus/2002/12/LogicalApplicabilityRules">
          <lar:And>
            <lar:Not>
              <bar:RegValueExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Key="HKEY_LOCAL_MACHINE" Subkey="System\CurrentControlSet\Control\Windows" Value="CSDVersion" Type="REG_DWORD"/>
            </lar:Not>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\wow32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.156"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\wow32.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\vdmdbg.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.153"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\vdmdbg.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdmd.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.153"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdmd.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\mf3216.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.132"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\mf3216.dll"/>
              </lar:Not>
            </lar:Or>
            <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\xpsp1hfm.exe" Comparison="GreaterThanOrEqualTo" Version="5.5.31.0"/>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\winsrv.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.153"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\winsrv.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\win32k.sys" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.166"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\win32k.sys"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\user32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.152"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\user32.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdm.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.157"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdm.exe"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\kernel32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.153"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\kernel32.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\gdi32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.151"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\gdi32.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\basesrv.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.159"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\basesrv.dll"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntoskrnl.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.160"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntoskrnl.exe"/>
              </lar:Not>
            </lar:Or>
            <lar:Or>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntkrnlpa.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.160"/>
              <lar:Not>
                <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntkrnlpa.exe"/>
              </lar:Not>
            </lar:Or>
          </lar:And>
          <lar:And>
            <bar:RegDword xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Key="HKEY_LOCAL_MACHINE" Subkey="System\CurrentControlSet\Control\Windows" Value="CSDVersion" Comparison="EqualTo" Data="256"/>
            <lar:And>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\wow32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1562"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\wow32.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\vdmdbg.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1560"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\vdmdbg.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdmd.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1560"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdmd.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\mf3216.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1331"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\mf3216.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\krnl386.exe" Comparison="GreaterThanOrEqualTo" Version="3.10.0.103"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\krnl386.exe"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\winsrv.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1561"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\winsrv.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\winlogon.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1557"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\winlogon.exe"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\win32k.sys" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1581"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\win32k.sys"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\user32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1561"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\user32.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdm.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1564"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntvdm.exe"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\kernel32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1560"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\kernel32.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\gdi32.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1561"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\gdi32.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\basesrv.dll" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1566"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\basesrv.dll"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntoskrnl.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1568"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntoskrnl.exe"/>
                </lar:Not>
              </lar:Or>
              <lar:Or>
                <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntkrnlpa.exe" Comparison="GreaterThanOrEqualTo" Version="5.1.2600.1568"/>
                <lar:Not>
                  <bar:FileExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Csidl="37" Path="\ntkrnlpa.exe"/>
                </lar:Not>
              </lar:Or>
            </lar:And>
          </lar:And>
        </lar:Or>
      </upd:IsInstalled>
      <upd:IsInstallable>
        <lar:Or xmlns:lar="http://schemas.microsoft.com/msus/2002/12/LogicalApplicabilityRules">
          <lar:Not>
            <bar:RegKeyExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Key="HKEY_LOCAL_MACHINE" Subkey="SOFTWARE\Microsoft\Updates\Windows XP\SP2\KB840987"/>
          </lar:Not>
          <lar:And>
            <lar:Not>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Path="ntvdmd.dll" Comparison="GreaterThan" Version="5.1.2600.153" Csidl="37"/>
            </lar:Not>
            <lar:Not>
              <bar:FileVersion xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Path="vdmdbg.dll" Comparison="GreaterThan" Version="5.1.2600.153" Csidl="37"/>
            </lar:Not>
            <bar:RegKeyExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Key="HKEY_LOCAL_MACHINE" Subkey="SOFTWARE\Microsoft\Updates\Windows XP\SP2\KB887822"/>
            <bar:RegDword xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Key="HKEY_LOCAL_MACHINE" Subkey="System\CurrentControlSet\Control\Windows" Value="CSDVersion" Comparison="EqualTo" Data="256"/>
            <bar:RegKeyExists xmlns:bar="http://schemas.microsoft.com/msus/2002/12/BaseApplicabilityRules" Key="HKEY_LOCAL_MACHINE" Subkey="SOFTWARE\Microsoft\Updates\Windows XP\SP2\KB840987"/>
          </lar:And>
        </lar:Or>
      </upd:IsInstallable>
    </upd:ApplicabilityRules>
    <upd:Files>
      <upd:File Digest="eQKAWuqu99NIFLBl19QV4yZUlcI=" DigestAlgorithm="SHA1" FileName="WindowsXP-KB840987-x86-cht.exe" Size="6087400" Modified="2004-10-11T18:22:41.8985179-07:00" PatchingType="SelfContained"/>
      <upd:File Digest="BMnBAul8I0xLhmfI16i0cG2I7yk=" DigestAlgorithm="SHA1" FileName="WindowsXP-KB840987-x86-cht.psf" Size="73317616" Modified="2004-10-11T18:24:13.4905093-07:00" PatchingType="Express"/>
      <upd:File Digest="RV8Eev3UlRe0OK6mxM5KMHpYzrQ=" DigestAlgorithm="SHA1" FileName="WindowsXP-KB840987-x86-express-cht.exe" Size="340200" Modified="2004-10-11T18:24:14.4123666-07:00" PatchingType="Express"/>
    </upd:Files>
    <upd:HandlerSpecificData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pub="http://schemas.microsoft.com/msus/2002/12/Publishing" xsi:type="psf:WindowsPatch">
      <psf:WindowsPatchData xmlns:psf="http://schemas.microsoft.com/msus/2002/12/UpdateHandlers/WindowsPatch" InstallParameters="-q /Z -ER"/>
    </upd:HandlerSpecificData>
  </upd:Update>

